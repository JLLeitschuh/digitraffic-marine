version: '2.1'

networks:
  db_network:
    external:
      name: dnet1

services:
  db:
    image: postgres:9.6.11
    restart: always
    environment:
      POSTGRES_USER: marine
      POSTGRES_PASSWORD: marine
      POSTGRES_DB: marine
    networks:
      - db_network

  db-wait:
      build: .
      volumes:
          - "./sql:/sql"
          - "~/.m2:/root/.m2"
      links:
          - "db:db"
      command: ["./wait-for-postgres.sh", "db", "marine", "marine", "marine"]
